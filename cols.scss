/*
	
	cols.fab 0.8.1
	
*/


/* --- VARS --- */

// Max cols number
$colnb: 12;

// Container max-width
$mw: 1280;

// Widths
$widths: 
	w20 20%, 
	w25 25%, 
	w30 30%, 
	w33 33.33%, 
	w40 40%, 
	w50 50%, 
	w60 60%, 
	w66 66.66%, 
	w70 70%, 
	w75 75%, 
	w80 80%, 
	w100 100%
;

// Var by breakpoint: class; breakpoint width; margin-left; margin-top; widths classes;
$breakpoints: 
	full 5000 2.3% 30px $widths, 
	bp1280 1280 2.3% 2.3vw $widths, 
	bp1024 1024 2.3% 2.3vw $widths, 
	bp900 900 2.3% 2.3vw $widths, 
	bp768 768 2.3% 2.3vw $widths, 
	bp600 600 2.3% 2.3vw $widths, 
	bp480 480 2.3% 2.3vw $widths, 
	bp400 400 2.3% 2.3vw $widths
;


/* --- CLASSES --- */

.cols {
  display: flex;
}
[class*='cols-'] {
	flex-wrap: wrap;
}
.col {
  position: relative;
  box-sizing: border-box;
}

// Breakpoints
@each $breakpoint in $breakpoints {
  
  $bpclass: nth($breakpoint, 1);
  $bpvalue: nth($breakpoint, 2);
  $bpm: nth($breakpoint, 3);
  $bpmt: nth($breakpoint, 4);
  $bpwidths: nth($breakpoint, 5);
  
  @media all and (max-width: #{$bpvalue}px) {
    
    // Basic widths class
    @each $width in $bpwidths {
      $wclass: nth($width, 1);
      $wvalue: nth($width, 2);
      .#{$wclass}-#{$bpclass} {
        width: $wvalue;
      }
    }
    
    // Margin-left
    .cols.colsm > .col+.col { margin-left: $bpm; }
    
    //Cols w/ the same width w/o margin
    @for $i from 1 through $colnb {
      
      .cols-#{$i}-#{$bpclass} > .col,
    	.colsd-#{$bpclass} > .col:first-child:nth-last-child(#{$i}),
    	.colsd-#{$bpclass} > .col:first-child:nth-last-child(#{$i}) ~ .col {
    	  width: ((100% / $i));
    	}
    	
    	//Custom col width
    	@each $width in $bpwidths {
    	  $wclass: nth($width, 1);
    	  $wvalue: nth($width, 2);
    	  .cols-#{$i}-#{$bpclass} > .col.#{$wclass}-#{$bpclass} {
    	    width: $wvalue;
    	  }
    	}
    	
    }
    
    //Cols w/ the same width w/ margin
    @for $i from 1 through $colnb {
      
      .cols-#{$i}-#{$bpclass}.colsm > .col,
    	.colsd-#{$bpclass}.colsm > .col:first-child:nth-last-child(#{$i}),
    	.colsd-#{$bpclass}.colsm > .col:first-child:nth-last-child(#{$i}) ~ .col {
    	  width: (((100% / $i) - (($bpm*($i - 1)) / $i)) - 0.1);
    	}
    	
    	// Add margin-top to .colsm
    	@for $ii from 1 through $colnb {
      	.cols-#{$i}-#{$bpclass}.colsm > .col:nth-child(#{$ii}) {
        	margin-top: $bpmt;
      	}
      }
    	
    	//Prevent margin-top on first row
    	@for $iii from 1 through $i {
      	.cols-#{$i}-#{$bpclass}.colsm > .col:nth-child(#{$iii}) {
        	margin-top: 0;
      	}
      }
    	
    	//Custom col width
    	@each $width in $bpwidths {
    	  $wclass: nth($width, 1);
    	  $wvalue: nth($width, 2);
    	  .cols-#{$i}-#{$bpclass}.colsm > .col.#{$wclass}-#{$bpclass} {
    	    width: ($wvalue - (($bpm*($i - 1)) / $i) - 0.1);
    	  }
    	}
    	
    	.cols-#{$i}-#{$bpclass}.colsm > .col:nth-child(#{$i}n+1) {
    	  margin-left: 0;
    	}
    	
    }

  }
 
}